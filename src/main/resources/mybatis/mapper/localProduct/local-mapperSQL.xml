<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "//mybatis.org/DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
	<mapper namespace="lpBoard">
		
		
		
		
		<!-- 절취선(위는 제철 아래는 지역 ) -->
		
		<!-- 리스트 -->
		<select id="LocalProductListPage" resultType="lpBoard"  parameterType="lpBoard">
			select  LOCALPRODUCT_NO as LocalProductNo,
			        LOCALPRODUCT_TITLE as LocalProductTitle,
			        LOCALPRODUCT_CONTENT as LocalProductContent,
			        LOCALPRODUCT_REGDATE as LocalProductRegDate,
			        LOCALPRODUCT.LOCALPRODUCTPHOTO_NO as LocalProductPhotoNo,
			        LOCALPRODUCT.LOCALPRODUCT_DEL_YN as LocalProductDelYN,
			        LOCALPRODUCT.LOCALPRODUCT_CLASSIFY as LocalProductClassify,
			        LOCALPRODUCTPHOTO.LOCALPRODUCTPHOTO_FILEPATH as LocalProductPhotoFilePath
			from    LOCALPRODUCT left join LOCALPRODUCTPHOTO on (LOCALPRODUCT.LocalproductPhoto_no=LOCALPRODUCTPHOTO.LocalproductPhoto_no)
			where 	LOCALPRODUCT.LOCALPRODUCT_DEL_YN = 'N'
		</select>
		
		<!-- 게시글 갯수 -->
		<select id="LocalProductTotalCount" resultType="integer">
			SELECT COUNT(*)
			FROM LOCALPRODUCT
		</select>
		
		<!-- 글 쓰기 전체 sql문 -->
			<!-- 이미지 첨부 -->
			<insert id="localPhotoAjax" parameterType="lpBoard">
				<selectKey keyProperty="LocalProductPhotoNo" resultType="integer" order="AFTER">
					select		LocalproductPhoto_no
					from		LOCALPRODUCTPHOTO
					where		LocalProductPhoto_UpdateTime=#{LocalProductPhotoUpdateTime}
				</selectKey>
				insert into		LOCALPRODUCTPHOTO
				values			(LOCALPRODUCTPHOTO_SEQ.nextval,
								#{LocalProductPhotoOriginal},
								#{LocalProductPhotoChange},
								#{LocalProductPhotoFilePath},
								#{LocalProductPhotoFileSize},
								#{LocalProductPhotoUpdateTime},
								'N')
			</insert>
			
			<!-- 글 쓰기 -->
			<insert id="localWrite" parameterType="lpBoard">
			insert into		LOCALPRODUCT
			values			(LOCALPRODUCT_SEQ.nextval,
							#{localProductTitle},
							#{localProductContent},
							sysdate,
							#{localProductPhotoNo},
							'N',
							#{localProductClassify})
			</insert>
		<!-- 글 쓰기 전체 sql문 끝 -->
		
		<!-- 글 조회 -->
		<select id="LocalProductView" parameterType="integer" resultType="lpBoard">
			select  LOCALPRODUCT_NO as LocalProductNo,
			        LOCALPRODUCT_TITLE as LocalProductTitle,
			        LOCALPRODUCT_CONTENT as LocalProductContent,
			        LOCALPRODUCT_REGDATE as LocalProductRegDate,
			        LOCALPRODUCT.LOCALPRODUCTPHOTO_NO as LocalProductPhotoNo,
			        LOCALPRODUCT.LOCALPRODUCT_DEL_YN as LocalProductDelYN,
			        LOCALPRODUCT.LOCALPRODUCT_CLASSIFY as LocalProductClassify,
			        LOCALPRODUCTPHOTO.LOCALPRODUCTPHOTO_FILEPATH as LocalProductPhotoFilePath
			from    LOCALPRODUCT left join LOCALPRODUCTPHOTO on (LOCALPRODUCT.LocalproductPhoto_no=LOCALPRODUCTPHOTO.LocalproductPhoto_no)
			where 	LOCALPRODUCT_NO = #{_parameter}
		</select>
		
		<select id="productintroLocalBtn" resultType="lpBoard" parameterType="string">
				select  LOCALPRODUCT_NO as LocalProductNo,
				        LOCALPRODUCT_TITLE as LocalProductTitle,
				        LOCALPRODUCT_CONTENT as LocalProductContent,
				        LOCALPRODUCT_REGDATE as LocalProductRegDate,
				        LOCALPRODUCT.LOCALPRODUCTPHOTO_NO as LocalProductPhotoNo,
				        LOCALPRODUCT.LOCALPRODUCT_DEL_YN as LocalProductDelYN,
				        LOCALPRODUCT.LOCALPRODUCT_CLASSIFY as LocalProductClassify,
				        LOCALPRODUCTPHOTO.LOCALPRODUCTPHOTO_FILEPATH as LocalProductPhotoFilePath
				from    LOCALPRODUCT left join LOCALPRODUCTPHOTO on (LOCALPRODUCT.LocalproductPhoto_no=LOCALPRODUCTPHOTO.LocalproductPhoto_no)
				where 	LOCALPRODUCT.LOCALPRODUCT_DEL_YN = 'N' 
			<if test="!_parameter.equals('ALL')">
				and LOCALPRODUCT.LOCALPRODUCT_CLASSIFY=#{LocalProductClassify}
			</if>
		</select>
	</mapper>


